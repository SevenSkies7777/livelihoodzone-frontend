<div class="w-100-p" id="no-print">
    <page-header title="Questionnaire Responses"></page-header>
    <div class="w-100-p d-flex px-0">
        <div class="w-100-p d-flex px-5">
            <!-- CONTENT -->
            <div class="w-100-p raised mb-5 bg-white mat-elevation-z1 mt-3"
            style="border-radius: 4px;">
                <mat-tab-group color="primary"
                (selectedTabChange)="tabSelected($event)">
                    <mat-tab>
                        <ng-template mat-tab-label>
                            <span class="text-dark">Wealth Group Level</span>
                        </ng-template>
                        <div *ngTemplateOutlet="wealthGroupList"></div>
                    </mat-tab>
                    <mat-tab>
                        <ng-template mat-tab-label>
                            <span class="text-dark">Zone Level</span>
                        </ng-template>
                        <div *ngIf="activeTab === 1">
                            <div *ngTemplateOutlet="countyList"></div>
                        </div>
                    </mat-tab>
                </mat-tab-group>
            </div>
            <!-- /CONTENT -->
        </div>
    </div>
</div>

<ng-template #wealthGroupList>
    <div class="w-100-p">
        <table class="table table-striped">
            <thead>
                <tr>
                    <th [class.pl-16]="i === 0"
                    *ngFor="let header of headerConfig;let i = index;">
                        {{ header?.name }}
                    </th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let resp of data">
                    <td class="pl-16">
                        <div class="pb-0">{{ resp?.questionnaireSessionDescription }}</div>
                        <div class="d-flex align-items-center">
                            <div class="pr-0 pt-2">
                                <mat-icon class="mt-1 font-size-16 text-muted">
                                    access_time
                                </mat-icon>
                            </div>
                            <div>
                                <div class="d-flex font-size-13">
                                    <div class="text-muted">
                                        {{ resp?.sessionStartDate | date: 'dd MMM, yyyy hh:mm aa' }}
                                    </div>
                                    <div class="px-0 mt-n2">
                                        <mat-icon class="mt-n2 text-muted">minimize</mat-icon>
                                    </div>
                                    <div class="text-muted">
                                        {{ resp?.sessionEndDate | date: 'dd MMM, yyyy hh:mm a' }}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </td>
                    <td class="valign-middle">
                        {{ resp?.userDetails.firstName }}
                        &nbsp;{{ resp?.userDetails.surname }}
                    </td>
                    <td class="valign-middle">
                        {{ resp?.countyName }}
                    </td>
                    <td class="valign-middle">
                        {{ resp?.livelihoodzoneName }}
                    </td>
                    <td class="valign-middle">
                        {{ resp?.wealthGroupName || resp?.wealthGroupId }}
                    </td>
                    <td class="valign-middle pr-20"
                    style="width: 1px;">
                        <div class="d-flex">
                            <!-- Start of dropdown list -->
                            <button mat-mini-fab color="default"
                            class="mat-elevation-z1 border-primary bg-light pt-1 mr-3" 
                            aria-label="Click to select more actions"
                            [matMenuTriggerFor]="menu">
                                <mat-icon class="font-size-28 ml-n1 mt-n3 text-primary a font-weight-600">
                                    more_horiz
                                </mat-icon>
                            </button>
                            <!-- Start of dropdown menu -->
                            <mat-menu #menu="matMenu" #itemActions="matMenu">
                                <ng-template matMenuContent let-item="item">
                                    <button mat-menu-item 
                                    (click)="downLoadResponse('wealth-group-responses', resp)">
                                        <mat-icon class="fs-11 mr-0 pt-1 action-btn-pdf mt-n1 mr-2">
                                            <div *ngTemplateOutlet="pdf"></div>
                                        </mat-icon>
                                        &nbsp;Download PDF
                                    </button>
                                    <button mat-menu-item (click)="exportExcel('wealth-group-responses', resp)">
                                        <mat-icon class="fs-11 mr-0 pt-1 action-btn mt-n2 mr-2">
                                            <div *ngTemplateOutlet="excel"></div>
                                            
                                        </mat-icon>
                                        &nbsp;Download Excel
                                    </button>
                                </ng-template>
                            </mat-menu>
                            <!-- End of dropdown list -->
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</ng-template>

<ng-template #countyList>
    <div class="w-100-p">
        <table class="table table-striped">
            <thead>
                <tr>
                    <th [class.pl-16]="i === 0"
                    *ngFor="let header of countyHeaderConfig;let i = index;">
                        {{ header?.name }}
                    </th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let resp of countyData">
                    <td class="pl-16">
                        <div class="pb-0">{{ resp?.questionnaireSessionDescription }}</div>
                        <div class="d-flex align-items-center">
                            <div class="pr-0 pt-2">
                                <mat-icon class="mt-1 font-size-16 text-muted">
                                    access_time
                                </mat-icon>
                            </div>
                            <div>
                                <div class="d-flex font-size-13">
                                    <div class="text-muted">
                                        {{ resp?.sessionStartDate | date: 'dd MMM, yyyy hh:mm aaa' }}</div>
                                    <div class="px-0 mt-n2">
                                        <mat-icon class="mt-n2 text-muted">minimize</mat-icon>
                                    </div>
                                    <div class="text-muted">
                                        {{ resp?.sessionEndDate | date: 'dd MMM, yyyy hh:mm aaa' }}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </td>
                    <td class="valign-middle">
                        {{ resp?.userDetails.firstName }}
                        &nbsp;{{ resp?.userDetails.surname }}
                    </td>
                    <td class="valign-middle">
                        {{ resp?.countyName }}
                    </td>
                    <td class="valign-middle">
                        {{ resp?.livelihoodzoneName }}
                    </td>
                    <td class="valign-middle pr-20"
                    style="width: 1px;">
                        <button mat-mini-fab color="default"
                            class="mat-elevation-z1 border-primary bg-light pt-1 mr-3" 
                            aria-label="Click to select more actions"
                            [matMenuTriggerFor]="menu">
                                <mat-icon class="font-size-28 ml-n1 mt-n3 text-primary a font-weight-600">
                                    more_horiz
                                </mat-icon>
                            </button>
                            <!-- Start of dropdown menu -->
                            <mat-menu #menu="matMenu" #itemActions="matMenu">
                                <ng-template matMenuContent let-item="item">
                                    <button mat-menu-item 
                                    (click)="downLoadResponse('county-responses', resp)">
                                        <mat-icon class="fs-11 mr-0 pt-1 action-btn-pdf mt-n1 mr-2">
                                            <div *ngTemplateOutlet="pdf"></div>
                                        </mat-icon>
                                        &nbsp;Download PDF
                                    </button>
                                    <button mat-menu-item (click)="exportExcel('county-responses', resp)">
                                        <mat-icon class="fs-11 mr-0 pt-1 action-btn mt-n2 mr-2">
                                            <div *ngTemplateOutlet="excel"></div>
                                            
                                        </mat-icon>
                                        &nbsp;Download Excel
                                    </button>
                                </ng-template>
                            </mat-menu>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</ng-template>

<div id="print">
    <!-- WEALTH GROUP -->
    <div class="w-100-p"
    *ngIf="activeTab === 0">
        <div class="row no-gutters">
            <div class="col">
                <h1>
                    {{ questDetails['countyName'] }}&nbsp;
                    {{ getItemVal('questionnaireGeography.selectedLivelihoodZone.livelihoodZoneName',
                        questDetails) || ' ' }} Livelihood Zone 
                    {{ getItemVal('questionnaireGeography.selectedWealthGroup.wealthGroupName',
                    questDetails) || ' ' }}
                    wealth group Raw data questionnaire - {{ questDetails.userDetails?.firstName }}
                </h1>
                <div class="pt-24 w-100-p">
                    <div class="d-flex pb-12" 
                    *ngFor="let header of reportSections?.header">
                        <div class="col-3 pl-0 pr-0 mr-n2">
                            <span class="font-weight-600 font-size-16">
                                {{ header?.label }}
                            </span>
                        </div>
                        <div class="flex-fill font-size-16 ml-n3">
                            <span> {{ getVal(header?.key) }} </span>
                        </div>
                    </div>
                </div>

                <div class="pt-24 w-100-p">
                    <div class="card">
                        <div class="card-header bg-secondary">
                            <span class="font-weight-700">
                                B(i) {{ reportSections?.incomeAndFoodSourceResponses.title }}
                            </span>
                        </div>
                        <div class="card-content">
                            <div *ngFor="let item of 
                            reportSections?.incomeAndFoodSourceResponses.content"
                            class="row pb-8 border-bottom pt-8">
                                <div class="col-8 pl-32">
                                    {{ item.label }}
                                </div>
                                <div class="col-4">
                                    {{ getVal(item.key, 'incomeAndFoodSourceResponses') }}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="pt-24 w-100-p">
                    <div class="card">
                        <div class="card-header bg-secondary">
                            <span class="font-weight-700"> 
                                B(ii) {{reportSections?.foodConsumptionResponses.title}}
                            </span>
                        </div>
                        <div class="card-content">
                            <div class="w-100-p pb-8">
                                <table class="table">
                                    <thead>
                                        <th></th>
                                        <th *ngFor="let head of 
                                        reportSections?.foodConsumptionResponses.header">
                                            {{ head }}
                                        </th>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let item of 
                                        reportSections?.foodConsumptionResponses.content">
                                            <td class="pl-20">{{ item?.label }}</td>
                                            <td>
                                                {{ 
                                                    getVal(item.key + '.ownFarm', 'foodConsumptionResponses')
                                                }}
                                            </td>
                                            <td>
                                                {{ 
                                                    getVal(item.key + '.marketFoodPurchase', 'foodConsumptionResponses')
                                                }}
                                            </td>
                                            <td>
                                                {{ 
                                                    getVal(item.key + '.gifts', 'foodConsumptionResponses')
                                                }}
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- CROP CONTRI -->
                <div class="pt-24 w-100-p">
                    <div class="card">
                        <div class="card-header bg-secondary">
                            <span class="font-weight-700"> 
                                C. {{reportSections?.cropContributionResponseItems.title}}
                            </span>
                        </div>
                        <div class="card-content">
                            <div class="w-100-p pb-8">
                                <table class="table">
                                    <thead>
                                        <th></th>
                                        <th *ngFor="let head of 
                                        reportSections?.cropContributionResponseItems.header">
                                            {{ head }}
                                        </th>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let item of 
                                        reportSections?.cropContributionResponseItems.content">
                                            <td class="pl-20">
                                                {{ 
                                                    getItemVal('cropModel.cropName', item)
                                                }}
                                            </td>
                                            <td>
                                                {{ 
                                                    getItemVal('cashIncomeRank.actualValue', item)
                                                }}
                                            </td>
                                            <td>
                                                {{ 
                                                    getItemVal('cashIncomeApproxPercentage.actualValue', item)
                                                }}
                                            </td>
                                            <td>
                                                {{ 
                                                    getItemVal('foodConsumptionRank.actualValue', item)
                                                }}
                                            </td>
                                            <td>
                                                {{
                                                    getItemVal('foodConsumptionApproxPercentage.actualValue', item)
                                                }}
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- /CROP CONTRI -->

                <!-- LIVESTOCK -->
                <div class="pt-24 w-100-p">
                    <div class="card">
                        <div class="card-header bg-secondary">
                            <span class="font-weight-600"> 
                                D. {{reportSections?.livestockContributionResponses.title}}
                            </span>
                        </div>
                        <div class="card-content">
                            <div class="w-100-p pb-8">
                                <table class="table">
                                    <thead>
                                        <th class="pl-20"></th>
                                        <th *ngFor="let head of 
                                        reportSections?.livestockContributionResponses.header">
                                            {{ head }}
                                        </th>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let item of 
                                        reportSections?.livestockContributionResponses.content">
                                            <td class="pl-20"
                                            *ngFor="let data of reportSections?.livestockContributionResponses.rows">
                                                <span *ngIf="data === 'label'">
                                                    {{  getItemVal(data, item) }}
                                                </span>
                                                <span *ngIf="data !== 'label'">
                                                    {{  getItemVal(data + '.actualValue', item) }}
                                                </span>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- /LIVESTOCK -->

                <!-- LABOR -->
                <div class="pt-24 w-100-p">
                    <div class="card">
                        <div class="card-header bg-secondary">
                            <span class="font-weight-700"> 
                                E. {{reportSections?.labourPatternResponses.title}}
                            </span>
                        </div>
                        <div class="card-content">
                            <div class="w-100-p pb-8">
                                <table class="table">
                                    <thead>
                                        <th></th>
                                        <th *ngFor="let head of 
                                        reportSections?.labourPatternResponses.header">
                                            {{ head }}
                                        </th>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let item of 
                                        reportSections?.labourPatternResponses.content">
                                        <td class="pl-20"> {{ item?.label }} </td>
                                            <td>
                                                {{ 
                                                    getVal(item.key + '.women', 'labourPatternResponses')
                                                }}
                                            </td>
                                            <td>
                                                {{ 
                                                    getVal(item.key + '.men', 'labourPatternResponses')
                                                }}
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- /LABOR -->

                <!-- EXPENDITURE -->
                <div class="pt-24 w-100-p">
                    <div class="card">
                        <div class="card-header bg-secondary">
                            <span class="font-weight-700"> 
                                F. {{reportSections?.expenditurePatternsResponses.title}}
                            </span>
                        </div>
                        <div class="card-content">
                            <div class="w-100-p pb-8">
                                <table class="table">
                                    <!-- <thead>
                                        <th *ngFor="let head of 
                                        reportSections?.expenditurePatternsResponses.header">
                                            {{ head }}
                                        </th>
                                    </thead> -->
                                    <tbody>
                                        <tr *ngFor="let item of 
                                        reportSections?.expenditurePatternsResponses.content">
                                            <td class="pl-20"> {{ item?.label }} </td>
                                            <td style="width:1px" class="pr-24">
                                                {{ item?.value }}
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- /EXPENDITURE -->

                <!-- MIGRATIONS -->
                <div class="pt-24 w-100-p">
                    <div class="card">
                        <div class="card-header bg-secondary">
                            <span class="font-weight-700"> 
                                G. {{reportSections?.migrationPatternResponses.title}}
                            </span>
                        </div>
                        <div class="card-content">
                            <div class="w-100-p pb-8">
                                <table class="table">
                                    <!-- <thead>
                                        <th *ngFor="let head of 
                                        reportSections?.expenditurePatternsResponses.header">
                                            {{ head }}
                                        </th>
                                    </thead> -->
                                    <tbody>
                                        <tr *ngFor="let item of 
                                        reportSections?.migrationPatternResponses.content">
                                            <td class="pl-20"> {{ item?.label }} </td>
                                            <td style="width:1px" class="pr-24">
                                                {{ item?.value }}
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- /MIGRATIONS -->

                <!-- CONSTRAINTS -->
                <div class="pt-24 w-100-p">
                    <div class="card">
                        <div class="card-header bg-secondary">
                            <span class="font-weight-700"> 
                                H. {{reportSections?.constraintsResponses.title}}
                            </span>
                        </div>
                        <div class="card-content">
                            <div class="w-100-p pb-8" 
                            *ngFor="let item of reportSections?.constraintsResponses.content">
                                <div class="border-top border-bottom w-100-p 
                                bg-light pl-20 pb-8 pt-8">
                                    <span class="font-weight-600 font-size-16">
                                        {{ item?.title }}
                                    </span>
                                </div>
                                <table class="table">
                                    <tbody>
                                        <tr *ngFor="let nested of item.value">
                                            <td class="pl-20"> {{ nested?.label }} </td>
                                            <td style="width:1px" class="pr-24">
                                                {{ nested?.value }}
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- /CONSTRAINTS -->

                <!-- PARTICIOANTS -->
                <div class="pt-24 w-100-p">
                    <div class="card">
                        <div class="card-header bg-secondary">
                            <span class="font-weight-700"> 
                                I. {{reportSections?.fdgParticipants.title}}
                            </span>
                        </div>
                        <div class="card-content">
                            <div class="w-100-p pb-8">
                                <table class="table">
                                    <thead>
                                        <th *ngFor="let head of 
                                        reportSections?.fdgParticipants.header; let i = index;"
                                        [class.pl-20]="i === 0">
                                            {{ head }}
                                        </th>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let item of 
                                        reportSections?.fdgParticipants.content">
                                            <td class="pl-20">
                                                {{  getItemVal('participantName', item) }}
                                            </td>
                                            <td> {{  getMapItemVal('age', item) }} </td>
                                            <td> {{ getItemVal('gender', item) === 1 
                                                    ? 'Male' : 'Female' }} </td>
                                            <td> {{  getItemVal('disability', item) }} </td>
                                            <td> {{ getMapItemVal('levelOfEducation', item)  }} </td>
                                            <td> {{ getItemVal('consentToParticipate', item) === 1 
                                                    ? 'Consented' : 'Not consented' }} </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- /PARTICIPANTS -->

            </div>
        </div>
    </div>
    <!-- /WEALTH GROUP -->

    <!-- ZONE LEVEL -->
    <div class="w-100-p" *ngIf="activeTab === 1">
        <div class="w-100-p">
            <h1>
                {{ questDetails['countyName'] }}&nbsp;
                {{ getItemVal('selectedLivelihoodZone.livelihoodZoneName',
                    questDetails) || ' ' }} Livelihood Zone 
                zone level questionnaire - {{ questDetails.userDetails?.firstName }}
            </h1>
        </div>
        <div class="pt-24 w-100-p">
            <div class="d-flex pb-12" 
            *ngFor="let header of countyReportsSections?.header">
                <div class="col-3 pl-0 pr-0 mr-n2">
                    <span class="font-weight-600 font-size-16">
                        {{ header?.label }}
                    </span>
                </div>
                <div class="flex-fill font-size-16 ml-n3">
                    <span> {{ getVal(header?.key) }} </span>
                </div>
            </div>
        </div>
        
        <div class="pt-24 w-100-p">
            <div class="font-weight-18 font-weight-700 pt-24 pb-8">
                WEALTH GROUP CHARACTERISTICS REPONSES
            </div>
            <div class="d-flex pb-8 pt-8 pl-2" 
            *ngFor="let item of 
            questDetails?.wealthGroupCharectariticsResponses | keyvalue">
                <div class="col-3 pl-0 pr-0 mr-n2">
                    <span class="font-weight-500 font-size-16">
                        {{ toSentenceCase(item?.key) }}
                    </span>
                </div>
                <div class="flex-fill font-size-16 ml-n3 text-muted">
                    <ul class="list-inline mb-1">
                        <li class="list-inline-item mr-2"
                        *ngFor="let val of item?.value; let i = index">
                            {{ val }}<span *ngIf="(i + 1) !== item?.value.length">,</span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="pt-24 w-100-p">
            <div class="font-weight-18 font-weight-700 pt-24 pb-8">
                WEALTH GROUP PERCENTAGES
            </div>
            <div class="d-flex pb-8 pt-8 pl-2" 
            *ngFor="let subHeader of countyReportsSections?.wealthGroupResponse">
                <div class="col-3 pl-0 pr-0 mr-n2">
                    <span class="font-weight-500 font-size-16">
                        {{ subHeader?.label }}
                    </span>
                </div>
                <div class="flex-fill font-size-16 ml-n3 text-muted">
                    <span> {{ getVal(subHeader?.key) }}% </span>
                </div>
            </div>
        </div>

        <!-- CROP PROD -->
        <div class="pt-36 w-100-p">
            <div class="card">
                <div class="card-header bg-secondary">
                    <span class="font-weight-600"> 
                        D. {{countyReportsSections?.lzCropProductionResponses.title}}
                    </span>
                </div>
                <div class="card-content">
                    <div class="w-100-p pb-8">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th rowspan="2"></th>
                                    <th rowspan="2" class="pl-20"
                                    colspan="3">
                                        Long Rains
                                    </th>
                                    <th rowspan="2" class="pl-20"
                                    colspan="3">
                                        Short Rains
                                    </th>
                                </tr>
                                
                            </thead>
                            <tbody>
                                <tr>
                                    <th class="pl-20 font-size-12 valign-middle">
                                        Crop
                                    </th>
                                    <th class="pl-20 font-size-12">
                                        Rainfed %age cultivated area
                                    </th>
                                    <th class="pl-20 font-size-12">
                                        Rainfed avg yield per HA
                                    </th>
                                    <th class="pl-20 font-size-12">
                                        Irrigated %age cultivated area
                                    </th>
                                    <th class="pl-20 font-size-12">
                                        Rainfed %age cultivated area
                                    </th>
                                    <th class="pl-20 font-size-12">
                                        Rainfed avg yield per HA
                                    </th>
                                    <th class="pl-20 font-size-12">
                                        Irrigated %age cultivated area
                                    </th>
                                </tr>
                                <tr *ngFor="let item of 
                                countyReportsSections?.lzCropProductionResponses.content">
                                    <td *ngFor="let data of item.value"
                                    class="pl-20">
                                        {{ data }}
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <!-- /CROP PROD -->

        <!-- WATER -->
        <div class="pt-36 w-100-p">
            <div class="card">
                <div class="card-header bg-secondary">
                    <span class="font-weight-600"> 
                        E. {{countyReportsSections?.waterSourceResponses.title}}
                    </span>
                </div>
                <div class="card-content">
                    <div class="w-100-p pb-8">
                        <table class="table">
                            <thead>
                                <th></th>
                                <th *ngFor="let head of 
                                countyReportsSections?.waterSourceResponses.header; let i = index;"
                                class="pl-20">
                                    {{ head }}
                                </th>
                            </thead>
                            <tbody>
                                <tr *ngFor="let item of 
                                countyReportsSections?.waterSourceResponses.content">
                                    <td class="pl-20"
                                    *ngFor="let data of countyReportsSections?.waterSourceResponses.rows">
                                        <span>
                                            {{  getItemVal(data, item) }}
                                        </span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <!-- /WATER -->

        <!-- MARKET -->
        <div class="pt-24 w-100-p">
            <div class="card">
                <div class="card-header bg-secondary">
                    <span class="font-weight-600"> 
                        F. {{countyReportsSections?.marketTransactionItems.title}}
                    </span>
                </div>
                <div class="card-content">
                    <div class="w-100-p pb-8">
                        <table class="table">
                            <thead>
                                <th *ngFor="let head of 
                                countyReportsSections?.marketTransactionItems.header; let i = index;"
                                class="pl-20">
                                    {{ head }}
                                </th>
                            </thead>
                            <tbody>
                                <tr *ngFor="let item of 
                                countyReportsSections?.marketTransactionItems.content">
                                    <td class="pl-20"
                                    *ngFor="let data of countyReportsSections?.marketTransactionItems.rows">
                                        <span>
                                            {{  getItemVal(data, item) }}
                                        </span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <!-- /MARKET -->

        <!-- ETHNIC GROUP -->
        <div class="pt-24 w-100-p">
            <div class="card">
                <div class="card-header bg-secondary">
                    <span class="font-weight-600"> 
                        G. {{countyReportsSections?.ethnicGroupResponseList.title}}
                    </span>
                </div>
                <div class="card-content">
                    <div class="w-100-p pb-8">
                        <table class="table">
                            <thead>
                                <th *ngFor="let head of 
                                countyReportsSections?.ethnicGroupResponseList.header; let i = index;"
                                class="pl-20">
                                    {{ head }}
                                </th>
                            </thead>
                            <tbody>
                                <tr *ngFor="let item of 
                                countyReportsSections?.ethnicGroupResponseList.content">
                                    <td class="pl-20"
                                    *ngFor="let data of countyReportsSections?.ethnicGroupResponseList.rows">
                                        <span *ngIf="data !== 'populationPercentage'">
                                            {{  getItemVal(data + '.ethnicGroupName', item) }}
                                        </span>
                                        <span *ngIf="data === 'populationPercentage'">
                                            {{  getItemVal(data, item) }}
                                        </span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <!-- /ETHNIC GROUP -->

         <!-- HUNGER -->
         <div class="pt-24 w-100-p">
            <div class="card">
                <div class="card-header bg-secondary">
                    <span class="font-weight-600"> 
                        H. {{countyReportsSections?.hungerPatternsResponses.title}}
                    </span>
                </div>
                <div class="card-content">
                    <div class="w-100-p pb-8">
                        <table class="table">
                            <thead>
                                <th *ngFor="let head of 
                                countyReportsSections?.hungerPatternsResponses.header; let i = index;"
                                class="pl-20">
                                    {{ head }}
                                </th>
                            </thead>
                            <tbody>
                                <tr *ngFor="let item of 
                                countyReportsSections?.hungerPatternsResponses.content">
                                    <td class="pl-20">
                                        {{ item?.label }}
                                    </td>
                                    <td class="pl-20">
                                        <span>
                                            {{  item?.value }}
                                        </span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <!-- /HUNGER -->

        <!-- HAZARD -->
        <div class="pt-24 w-100-p">
            <div class="card">
                <div class="card-header bg-secondary">
                    <span class="font-weight-600"> 
                        I. {{countyReportsSections?.hazardResponses.title}}
                    </span>
                </div>
                <div class="card-content">
                    <div class="w-100-p pb-8">
                        <table class="table">
                            <thead>
                                <th></th>
                                <th *ngFor="let head of 
                                countyReportsSections?.hazardResponses.header; let i = index;"
                                class="pl-20">
                                    {{ head }}
                                </th>
                            </thead>
                            <tbody>
                                <tr *ngFor="let item of 
                                countyReportsSections?.hazardResponses.content">
                                    <td class="pl-20"
                                    *ngFor="let data of countyReportsSections?.hazardResponses.rows">
                                        <span>
                                            {{  getItemVal(data, item) }}
                                        </span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <!-- /HAZARD -->

        <!-- SEASON -->
        <div class="pt-24 w-100-p">
            <div class="card">
                <div class="card-header bg-primary">
                    <span class="font-weight-600"> 
                        J. {{countyReportsSections?.livelihoodZoneSeasonsResponses.title}}
                    </span>
                </div>
                <div class="card-content">
                    <div class="w-100-p pb-8">
                        <table class="table table-bordered">
                            <tbody>
                                <tr>
                                    <th class="pl-20">Seasons</th>
                                    <th *ngFor="let month of monthsList; let i = index;"
                                    class="pl-20 font-size-12">
                                        {{ month?.monthName | slice:0:3 }}
                                    </th>
                                </tr>
                                <tr *ngFor="let item of 
                                countyReportsSections?.livelihoodZoneSeasonsResponses.seasonContent">
                                    <td class="pl-20">
                                        {{ item?.label }}
                                    </td>
                                    <td *ngFor="let month of monthsList; let i = index;"
                                    class="pl-20 font-size-12">
                                        <span *ngFor="let monthVal of item?.value">
                                            <mat-icon *ngIf="month.monthId === monthVal.monthId"
                                            class="text-success">check</mat-icon>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <th class="pl-20">Land Preparations</th>
                                    <th *ngFor="let month of monthsList; let i = index;"
                                    class="pl-20 font-size-12">
                                        {{ month?.monthName | slice:0:3 }}
                                    </th>
                                </tr>
                                <tr *ngFor="let item of 
                                countyReportsSections?.landPreparationPeriod">
                                    <td class="pl-20">
                                        {{ item?.label }}
                                    </td>
                                    <td *ngFor="let month of monthsList; let i = index;"
                                    class="pl-20 font-size-12">
                                        <span *ngFor="let monthVal of item?.value">
                                            <mat-icon *ngIf="month.monthId === monthVal.monthId"
                                            class="text-success">check</mat-icon>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <th class="pl-20">Planting Preparations</th>
                                    <th *ngFor="let month of monthsList; let i = index;"
                                    class="pl-20 font-size-12">
                                        {{ month?.monthName | slice:0:3 }}
                                    </th>
                                </tr>
                                <tr *ngFor="let item of 
                                countyReportsSections?.plantingPeriod">
                                    <td class="pl-20">
                                        {{ item?.label }}
                                    </td>
                                    <td *ngFor="let month of monthsList; let i = index;"
                                    class="pl-20 font-size-12">
                                        <span *ngFor="let monthVal of item?.value">
                                            <mat-icon *ngIf="month.monthId === monthVal.monthId"
                                            class="text-success">check</mat-icon>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <th class="pl-20">Harvesting Preparations</th>
                                    <th *ngFor="let month of monthsList; let i = index;"
                                    class="pl-20 font-size-12">
                                        {{ month?.monthName | slice:0:3 }}
                                    </th>
                                </tr>
                                <tr *ngFor="let item of 
                                countyReportsSections?.harvestingPeriod">
                                    <td class="pl-20">
                                        {{ item?.label }}
                                    </td>
                                    <td *ngFor="let month of monthsList; let i = index;"
                                    class="pl-20 font-size-12">
                                        <span *ngFor="let monthVal of item?.value">
                                            <mat-icon *ngIf="month.monthId === monthVal.monthId"
                                            class="text-success">check</mat-icon>
                                        </span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <!-- /SEASON -->

    </div>
    <!-- /ZONE LEVEL -->
</div>
<ng-template #excel>
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
                                            aria-hidden="true" focusable="false" width="1em" height="1em" style="-ms-transform: rotate(360deg); 
                                            -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" 
                                            viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6m1.8 
                                            18H14l-2-3.4l-2 3.4H8.2l2.9-4.5L8.2 11H10l2 3.4l2-3.4h1.8l-2.9 4.5l2.9 4.5M13 9V3.5L18.5 9H13z" 
                                            fill="#2196f3"/></svg>
</ng-template>
<ng-template #pdf>
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" 
                                            focusable="false" width="1em" height="1em" style="-ms-transform: rotate(360deg); -webkit-transform: 
                                            rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><defs>
                                                <linearGradient id="IconifyId-17a8d91cb37-223943-8" x1="625.787" y1="825.641" x2="632.847" y2="812.848" 
                                                gradientTransform="rotate(.063 730247.83 -555381.24)" gradientUnits="userSpaceOnUse"><stop offset="0" 
                                                stop-color="#fff"/><stop offset="1" stop-color="#e1e1e1"/></linearGradient><linearGradient 
                                                id="IconifyId-17a8d91cb37-223943-9" x1="634.081" y1="810.251" x2="635.169" y2="809.248" 
                                                gradientTransform="translate(-610.524 -802.52)" gradientUnits="userSpaceOnUse"><stop offset="0" 
                                                stop-color="#fff"/><stop offset="1" stop-color="#c8c8c8"/></linearGradient><linearGradient 
                                                id="IconifyId-17a8d91cb37-223943-10" x1="14.019" y1="-116.816" x2="10.665" y2="-106.493" 
                                                gradientTransform="matrix(1 0 0 -1 .04 -103.785)" gradientUnits="userSpaceOnUse"><stop offset=".127" 
                                                stop-color="#8a0000"/><stop offset=".244" stop-color="#900000" stop-opacity=".999"/><stop offset=".398" 
                                                stop-color="#a00000" stop-opacity=".999"/><stop offset=".573" stop-color="#bc0000" stop-opacity=".998"/>
                                                <stop offset=".761" stop-color="#e20000" stop-opacity=".997"/><stop offset=".867" stop-color="#fa0000" 
                                                stop-opacity=".996"/></linearGradient><linearGradient id="IconifyId-17a8d91cb37-223943-11" x1="14.16" 
                                                y1="-117.225" x2="10.541" y2="-106.084" gradientTransform="matrix(1 0 0 -1 .04 -103.785)" 
                                                gradientUnits="userSpaceOnUse"><stop offset=".315" stop-color="#5e0000"/><stop offset=".444" 
                                                stop-color="#830000" stop-opacity=".999"/><stop offset=".618" stop-color="#ae0000" stop-opacity=".998"/>
                                                <stop offset=".775" stop-color="#cd0000" stop-opacity=".997"/><stop offset=".908" stop-color="#e00000" 
                                                stop-opacity=".996"/><stop offset="1" stop-color="#e70000" stop-opacity=".996"/></linearGradient></defs>
                                                <path d="M9.064 3.162h11.6a31.459 31.459 0 0 1 7.524 7.538v17.842H9.064z" 
                                                fill="url(#IconifyId-17a8d91cb37-223943-8)"/><path d="M9.064 3.162h11.6a31.459 31.459 0 0 1 7.524 7.538v17.842H9.064z" 
                                                fill="none" stroke="#c8c8c8" stroke-width=".5"/><path d="M20.662 3.162a31.807 31.807 0 0 1 7.526 7.538a6.765 6.765 0 
                                                0 0-5.332-2.03a6.025 6.025 0 0 0-2.194-5.508z" fill="url(#IconifyId-17a8d91cb37-223943-9)"/>
                                                <path d="M20.662 3.162a31.807 31.807 0 0 1 7.526 7.538a6.765 6.765 0 0 0-5.332-2.03a6.025 6.025 0 0 0-2.194-5.508z" 
                                                fill="none" stroke="#c8c8c8" stroke-width=".5"/><path fill="none" stroke="#c8c8c8" stroke-width="4" 
                                                d="M5.339 6.496h14.1v2.7h-14.1z"/><path d="M15.819 19.855c.466-.914 1-1.943 
                                                1.42-2.977l.168-.408c-.554-2.108-.886-3.8-.589-4.894a.755.755 0 0 1 .763-.458h.254c.484-.007.711.608.737.847a3.847 
                                                3.847 0 0 1-.141 1.072a2.639 2.639 0 0 0-.161-1.091c-.2-.439-.391-.7-.562-.743a.54.54 0 0 0-.2.407a5.874 5.874 0 0 
                                                0-.077.939a10.511 10.511 0 0 0 .433 2.729c.054-.156.1-.306.14-.447c.059-.222.433-1.691.433-1.691s-.094 1.956-.226 
                                                2.547c-.028.125-.059.249-.092.375a8.586 8.586 0 0 0 2.145 3.351a6.7 6.7 0 0 0 1.24.852a16.9 16.9 0 0 1 2.517-.189a3.153 
                                                3.153 0 0 1 1.938.433a.738.738 0 0 1 .213.484a1.446 1.446 0 0 1-.041.282c.01-.051.01-.3-.755-.546a8.91 8.91 0 0 
                                                0-3.086-.043c1.566.766 3.093 1.147 3.576.919a1.015 1.015 0 0 0 .262-.254a2.727 2.727 0 0 1-.146.484a.764.764 0 
                                                0 1-.377.258c-.764.2-2.752-.268-4.485-1.258a36.619 36.619 0 0 0-5.768 1.371c-1.675 2.936-2.935 4.284-3.959 
                                                3.771l-.377-.189a.436.436 0 0 1-.141-.474c.119-.584.852-1.465 2.324-2.344c.158-.1.864-.469.864-.469s-.523.506-.645.605c-1.175.963-2.042 
                                                2.174-2.021 2.644v.041c1-.142 2.495-2.174 4.419-5.939m.61.312a77.843 77.843 0 0 1-.926 1.682a24.582 24.582 0 0 1 4.975-1.408a8.276 8.276 0 0 1-.637-.485a8.531 8.531 0 0 1-2.1-2.729a23.388 23.388 0 0 1-1.317 2.94" fill="#f91d0a"/><path fill="url(#IconifyId-17a8d91cb37-223943-10)" d="M3.75 4.968h17.264v5.803H3.75z"/><path d="M21.343 11.119H3.437V4.62h17.906zM20.7 5.264H4.081v5.209H20.7z" fill="url(#IconifyId-17a8d91cb37-223943-11)"/><path d="M8.262 5.819h1.256a1.1 1.1 0 0 1 .859.331a1.338 1.338 0 0 1 .3.937a1.351 1.351 0 0 1-.3.942a1.1 1.1 0 0 1-.859.328h-.5v1.349h-.756V5.819m.757.726v1.086h.419a.423.423 0 0 0 .34-.141a.611.611 0 0 0 .12-.4a.6.6 0 0 0-.12-.4a.422.422 0 0 0-.34-.141h-.419m2.949.031v2.369h.271a.853.853 0 0 0 .708-.3a1.382 1.382 0 0 0 .246-.885a1.375 1.375 0 0 0-.244-.88a.858.858 0 0 0-.71-.3h-.271m-.757-.758h.8a2.9 2.9 0 0 1 .989.121a1.283 1.283 0 0 1 .562.427a1.779 1.779 0 0 1 .307.607a2.783 2.783 0 0 1 .1.779a2.831 2.831 0 0 1-.1.786a1.779 1.779 0 0 1-.307.607a1.313 1.313 0 0 1-.566.43a2.965 2.965 0 0 1-.991.125h-.8V5.819m3.342 0H16.6v.758h-1.29V7.3h1.209v.758H15.31v1.648h-.757V5.819" fill="#fff9f9"/></svg>
</ng-template>