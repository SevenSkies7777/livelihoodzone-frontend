(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{"0xq/":function(t,e,i){"use strict";i.r(e),i.d(e,"ApplicationsModule",(function(){return L}));var a=i("iInd"),n=i("s7LF"),c=i("iELJ"),o=i("e6WT"),s=i("Dxy4"),l=i("Tj54"),r=i("pu8Q"),d=i("Q2Ze"),b=i("5HBU"),p=i("RT2w"),g=i("/vS9"),f=i("jDA0"),u=i("lk0u"),h=i("LvDl"),y=i("buby"),m=i("8Y7J"),v=i("SVse"),T=i("f5Zh");function O(t,e){if(1&t&&(m.Ub(0,"th"),m.Mc(1),m.Tb()),2&t){const t=e.$implicit;m.Bb(1),m.Oc(" ",null==t?null:t.label," ")}}function _(t,e){if(1&t&&(m.Ub(0,"div"),m.Mc(1),m.Tb()),2&t){const t=m.gc().$implicit,e=m.gc(2).$implicit;m.Bb(1),m.Oc(" ",e[t.key]," ")}}function U(t,e){if(1&t&&(m.Ub(0,"div"),m.Mc(1),m.hc(2,"currency"),m.Tb()),2&t){const t=m.gc().$implicit,e=m.gc(2).$implicit;m.Bb(1),m.Oc(" ",m.jc(2,1,e[t.key],"Kshs ")," ")}}function M(t,e){if(1&t&&(m.Ub(0,"div"),m.Mc(1),m.hc(2,"date"),m.Tb()),2&t){const t=m.gc().$implicit,e=m.gc(2).$implicit;m.Bb(1),m.Oc(" ",m.jc(2,1,e[t.key],"dd-MM-yyyy")," ")}}function A(t,e){if(1&t&&(m.Ub(0,"div",23),m.Mc(1),m.Tb()),2&t){const t=m.gc(2).$implicit;m.Bb(1),m.Oc(" ",t.label,":\xa0 ")}}function P(t,e){if(1&t&&(m.Ub(0,"div",21),m.Kc(1,A,2,1,"div",22),m.Ub(2,"div"),m.Mc(3),m.Tb(),m.Tb()),2&t){const t=m.gc().$implicit,e=m.gc(2).$implicit,i=m.gc();m.Bb(1),m.nc("ngIf",t.label),m.Bb(2),m.Oc(" ",i.getNested(e,t.key)," ")}}function k(t,e){if(1&t&&(m.Ub(0,"div"),m.Ub(1,"span"),m.hc(2,"lowercase"),m.Mc(3),m.hc(4,"removeUnderscore"),m.hc(5,"uppercase"),m.Tb(),m.Tb()),2&t){const t=m.gc().$implicit,e=m.gc(2).$implicit;m.Bb(1),m.Eb("badge ",m.ic(2,4,e[t.key])," py-1 py-2"),m.Bb(2),m.Oc(" ",m.ic(4,6,m.ic(5,8,e[t.key]))," ")}}function w(t,e){if(1&t&&(m.Ub(0,"div",19),m.Kc(1,_,2,1,"div",12),m.Kc(2,U,3,4,"div",12),m.Kc(3,M,3,4,"div",12),m.Kc(4,P,4,2,"div",20),m.Kc(5,k,6,10,"div",12),m.Tb()),2&t){const t=e.$implicit;m.Bb(1),m.nc("ngIf","string"===t.type),m.Bb(1),m.nc("ngIf","currency"===t.type),m.Bb(1),m.nc("ngIf","date"===t.type),m.Bb(1),m.nc("ngIf","nested"===t.type),m.Bb(1),m.nc("ngIf","status"===t.type)}}function C(t,e){if(1&t&&(m.Ub(0,"td",17),m.Kc(1,w,6,5,"div",18),m.Tb()),2&t){const t=e.$implicit;m.Bb(1),m.nc("ngForOf",t.fields)}}function B(t,e){if(1&t){const t=m.Vb();m.Ub(0,"tr"),m.Kc(1,C,2,1,"td",15),m.Ub(2,"td",11),m.Ub(3,"button",16),m.cc("click",(function(){m.Ac(t);const i=e.$implicit;return m.gc().selectActivity(i)})),m.Mc(4,"SELECT"),m.Tb(),m.Tb(),m.Tb()}if(2&t){const t=m.gc();m.Bb(1),m.nc("ngForOf",t.tableConfigs)}}function S(t,e){if(1&t&&(m.Ub(0,"tr"),m.Ub(1,"td"),m.Ub(2,"div",24),m.Pb(3,"mat-spinner",25),m.Tb(),m.Tb(),m.Tb()),2&t){const t=m.gc();m.Bb(1),m.Cb("colspan",t.tableConfigs.length+1)}}function I(t,e){if(1&t&&(m.Ub(0,"tr"),m.Ub(1,"td"),m.Ub(2,"div",26),m.Ub(3,"div",27),m.Ub(4,"mat-icon",28),m.Mc(5,"folder_open"),m.Tb(),m.Tb(),m.Ub(6,"div",29),m.Mc(7," There are no approved activities. "),m.Tb(),m.Ub(8,"div",30),m.Mc(9," Once you have an approved budget with approved activities, the activities will "),m.Pb(10,"br"),m.Mc(11," appear here and you can use them to make an application. "),m.Tb(),m.Tb(),m.Tb(),m.Tb()),2&t){const t=m.gc();m.Bb(1),m.Cb("colspan",t.tableConfigs.length+1)}}let x=(()=>{class t{constructor(t,e){this._dataLayer=t,this._dialogRef=e,this.list=[],this.tableConfigs=[{label:"Title",fields:[{type:"string",key:"title"}]},{label:"Activity Date",fields:[{type:"date",key:"activity_date"}]},{label:"Applied Amount",fields:[{type:"currency",key:"total"}]},{label:"Approved Amount",fields:[{type:"currency",key:"actual_total"}]},{label:"Status",fields:[{type:"status",key:"status"}]}]}getNested(t,e){return Object(h.get)(t,e,null)}getActivities(){const t={current_org_id:this.organization,status:"SASDEF_APPROVED",limit:1e3};this.loading=!0,this._dataLayer.list("organization-budget-activities",t).subscribe(t=>{this.list=t.results,this.loading=!1},t=>{this.loading=!1,console.log(t)})}selectActivity(t){this.closeDialog(t)}getACtivityStatus(t){if(t.applications.length){let e=0;return t.applications.forEach(t=>{e+=parseFloat(t.amount_requested)}),parseFloat(t.estimated_amount),!1}}setAppliedAmount(t){if(t.applications.length){let e=0;return t.applications.forEach(t=>{e+=parseFloat(t.amount_requested)}),e}return 0}closeDialog(t){this._dialogRef.close(t)}ngOnInit(){const t=JSON.parse(localStorage.getItem("organization"));this.organization=Object(h.get)(t,"organization",null),this.getActivities()}}return t.\u0275fac=function(e){return new(e||t)(m.Ob(y.a),m.Ob(c.g))},t.\u0275cmp=m.Ib({type:t,selectors:[["activity-selection-dialog"]],features:[m.Ab([y.a])],decls:26,vars:4,consts:[["mat-dialog-title","",1,"font-size-14"],[1,"d-flex","align-items-center","mb-n3"],[1,"flex-fill"],[1,"search-form"],[1,"full-width"],["type","search","matInput","","placeholder","Search activity..."],["matSuffix","",1,"font-size-14"],[1,"mat-typography"],[1,"table"],[1,"thead-light"],[4,"ngFor","ngForOf"],[2,"width","1px"],[4,"ngIf"],["align","end",1,"pb-20","border-top","pt-8"],["mat-button","","mat-dialog-close","","cdkFocusInitial",""],["class","pb-1 align-middle",4,"ngFor","ngForOf"],["mat-raised-button","","color","defualt",3,"click"],[1,"pb-1","align-middle"],["class","pb-1",4,"ngFor","ngForOf"],[1,"pb-1"],["class","d-flex",4,"ngIf"],[1,"d-flex"],["class","text-muted",4,"ngIf"],[1,"text-muted"],[1,"d-flex","justify-content-center","py-16"],["diameter","40"],[1,"d-flex","flex-column","justify-content-center","py-16"],[1,"text-center"],[1,"font-size-100","w-100-p"],[1,"pt-16","text-center","font-size-18","pb-3"],[1,"pt-8","text-center","font-size-14","text-muted"]],template:function(t,e){1&t&&(m.Ub(0,"div",0),m.Ub(1,"div",1),m.Ub(2,"div",2),m.Mc(3,"Activities"),m.Tb(),m.Ub(4,"div"),m.Ub(5,"form",3),m.Ub(6,"mat-form-field",4),m.Ub(7,"mat-label"),m.Mc(8,"Search"),m.Tb(),m.Pb(9,"input",5),m.Ub(10,"mat-icon",6),m.Mc(11,"search"),m.Tb(),m.Tb(),m.Tb(),m.Tb(),m.Tb(),m.Tb(),m.Ub(12,"mat-dialog-content",7),m.Ub(13,"div"),m.Ub(14,"table",8),m.Ub(15,"thead",9),m.Ub(16,"tr"),m.Kc(17,O,2,1,"th",10),m.Pb(18,"th",11),m.Tb(),m.Tb(),m.Ub(19,"tbody"),m.Kc(20,B,5,1,"tr",10),m.Kc(21,S,4,1,"tr",12),m.Kc(22,I,12,1,"tr",12),m.Tb(),m.Tb(),m.Tb(),m.Tb(),m.Ub(23,"mat-dialog-actions",13),m.Ub(24,"button",14),m.Mc(25,"CLOSE"),m.Tb(),m.Tb()),2&t&&(m.Bb(17),m.nc("ngForOf",e.tableConfigs),m.Bb(3),m.nc("ngForOf",e.list),m.Bb(1),m.nc("ngIf",e.loading),m.Bb(1),m.nc("ngIf",!e.loading&&!e.list.length))},directives:[c.h,n.F,n.s,n.t,d.c,d.g,o.b,l.a,d.i,c.e,v.s,v.t,c.c,s.b,c.d,r.b],pipes:[v.d,v.f,v.p,T.a,v.G],styles:['[_nghost-%COMP%]    {font-family:RobotoDraft,Roboto,"Helvetica Neue, Helvetica, Arial",sans-serif;font-style:normal;font-weight:300;display:flex;flex-direction:column;width:100%}[_nghost-%COMP%]     .badge.open, [_nghost-%COMP%]     .badge.pending{background-color:#ffc107;color:#212529}[_nghost-%COMP%]     .badge.assigned, [_nghost-%COMP%]     .badge.rationalized{background-color:#2196f3;color:#fff}[_nghost-%COMP%]     .badge.cancelled{background-color:#dc3545;color:#fff}[_nghost-%COMP%]     .badge.inactive, [_nghost-%COMP%]     .badge.overdue{background-color:#343a40;color:#fff}[_nghost-%COMP%]     .badge.accepted, [_nghost-%COMP%]     .badge.active, [_nghost-%COMP%]     .badge.approved, [_nghost-%COMP%]     .badge.completed, [_nghost-%COMP%]     .badge.sasdef_approved, [_nghost-%COMP%]     .badge.submitted{background-color:#28a745;color:#fff}']}),t})();var F=i("IjP4"),z=i("l51w");let R=(()=>{class t{constructor(t,e){this._router=t,this._dialog=e,this.headers=[{title:"Organization"},{title:"Applied Amount"},{title:"Required By"},{title:"Financial Year"},{title:"Status"},{title:"Actions"}],this.rows=[{key:"organization",type:"nested",fieldType:"nested_string",primaryField:"organization_data.name"},{key:"amount_requested",type:"currency"},{key:"date_requested",type:"date"},{key:"financial_year",type:"nested",fieldType:"nested_range",primaryField:"financial_year_data.starts_on",secondaryField:"financial_year_data.ends_on"},{key:"status",type:"status"}],this.actions=[{btnText:"MANAGE",status:"accent",icon:!1,disableStatus:"FINISHED",action:"tabDetails",modalConf:{qParam:"organization",link:"/applications/details",queryParams:{current:2,step:1}}}],this.pageHeaderActions=[{btnText:"APPLY FUNDS",status:"accent",icon:!0,bpType:["GOVERNMENT_AGENCY","PROFESSIONAL_SPORTPERSON","SPORTS_ORGANIZATION","MINISTRY"],roles:["Admin","Representative","Budget Reviewer","Ministry Approver"],modalConf:{link:"/applications/add",queryParams:{current:1,step:1}}}]}openDialog(){this._dialog.open(x,{data:{context:"Application"},width:"75%"}).afterClosed().subscribe(t=>{Object(h.isObject)(t)&&this._router.navigate(["/applications/add"],{queryParams:Object.assign({current:1},{activity:t.id,budget:t.org_budget,organization:t.organization,amount:t.actual_total,activity_date:t.activity_date})})})}pageHeadeAction(t){Object(h.get)(JSON.parse(localStorage.getItem("organization")),"organization",null),this.openDialog()}}return t.\u0275fac=function(e){return new(e||t)(m.Ob(a.g),m.Ob(c.b))},t.\u0275cmp=m.Ib({type:t,selectors:[["applications-list"]],decls:5,vars:8,consts:[["title","Applications",3,"actions","navigate"],[1,"w-100-p","d-flex","px-5"],["title","Listing","store","applications",1,"w-100-p",3,"addOrg","headers","no-card","has-action","hasSearch","actions","rows"]],template:function(t,e){1&t&&(m.Ub(0,"div"),m.Ub(1,"page-header",0),m.cc("navigate",(function(t){return e.pageHeadeAction(t)})),m.Tb(),m.Tb(),m.Ub(2,"div",1),m.Ub(3,"div",1),m.Pb(4,"dynamic-table",2),m.Tb(),m.Tb()),2&t&&(m.Bb(1),m.nc("actions",e.pageHeaderActions),m.Bb(3),m.nc("addOrg",!0)("headers",e.headers)("no-card",!1)("has-action",!0)("hasSearch",!0)("actions",e.actions)("rows",e.rows))},directives:[F.a,z.a],styles:["[_nghost-%COMP%]{\n            width: 100%;\n        }"]}),t})();var E=i("nH2V"),N=i("RDeM");const j=[{path:"",component:u.a,children:[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:R},{path:"add",component:N.a,data:{stepsKey:"application",context:"Application",listRoute:"/applications"}},{path:"details",component:E.a,data:{store:"application",endPoint:"applications",listRoute:"/applications"}}]}];let D=(()=>{class t{}return t.\u0275mod=m.Mb({type:t}),t.\u0275inj=m.Lb({factory:function(e){return new(e||t)},imports:[[a.k.forChild(j)],a.k]}),t})();var $=i("2l/B"),K=i("5wFq");let L=(()=>{class t{}return t.\u0275mod=m.Mb({type:t}),t.\u0275inj=m.Lb({factory:function(e){return new(e||t)},imports:[[p.a,a.k,n.z,c.f,o.c,s.c,l.b,d.e,b.a,K.a,$.a,g.a,f.a,r.a,D]]}),t})()}}]);
//# sourceMappingURL=21-es2015.c7fcd3f785ed417f8cbd.js.map